# Causal-DiCE

This repository contains code and data used to implement the methods and run experiments described in

Afrabandpey, H., Spranger, M. "**Diverse and Feasible Counterfactual Explanations for Machine Learning Classifiers**." (2022)

The paper is available in unkown_link.com. 

## Overview

### Requirements

 * Python 3.7
    * pandas
	* numpy
    * scipy
    * scikit-learn
    * torch
    * matplotlib

## Basic Usage

The script [utils.py](utils.py) contains all the required functions to pre-process data, generate and visualize the counterfactual instances generated by the model. The script [main.R](main.R) has eight parameters:

```R
% dataset_id       ID of the data set to be used for training of the model {adult, german, sangiovese}
% dataset_path     The path where data set is available
% lr          	   Learning rate parameter of the black-box neural network
% n_epochs		   Number of training epochs for the black-box neural network
% batch_size	   Batch size to be used by the black-box neural network during training
% seed			   Random seed to be used when spliting data
% test_size		   Portion of the data to be used as test data in (0.0, 1.0)
% save_model	   Whether or not save the trained black-box model
```
To reproduce results in Section V.D in the paper, run the Python script [main.py](main.py) with default parameters.

Some functions were adopted form [DiCE repository](https://github.com/interpretml/DiCE) fetched in March 2020.

## Contact

 * Homayun Afrabandpey, homayun.it@gmail.com
 
 Work done in [Sony AI](https://ai.sony/), Tokyo, Japan.
 
 ## Reference

 * Afrabandpey, H., Spranger, M. "**Diverse and Feasible Counterfactual Explanations for Machine Learning Classifiers**." (paper link here)
